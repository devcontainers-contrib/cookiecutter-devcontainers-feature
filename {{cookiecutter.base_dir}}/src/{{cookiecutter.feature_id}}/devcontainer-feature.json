{%- set optional_aptget_packages = (cookiecutter.content.aptget | selectattr('optional', 'equalto', 'True') | list) -%}

{
    "name": "{{cookiecutter.feature_name}}",
    "id": "{{cookiecutter.feature_id}}",
    "version": "{{cookiecutter.version}}",
    "description": "{{cookiecutter.description}}",
    "documentationURL": "{{cookiecutter.gitrepo}}/tree/main/src/{{cookiecutter.feature_id}}",
    "installAfter": [
        "ghcr.io/devcontainers/features/python:latest"
    ],
    "options": {

        {% for aptget_package in optional_aptget_packages -%} 
   "include{{ aptget_package.display_name | replace(" ", "") |  replace("_", "") | replace("-", "") | to_camel}}": {
            "type": "boolean",
            "default": true,
            "description": "Include {{aptget_package.display_name}}"
        },
        {% endfor -%}

        {% for pipx_package in cookiecutter.content.pipx %}
        "{% if pipx_package.version_alias is defined %}{{pipx_package.version_alias}}{% else %}{{ pipx_package.display_name | lower | replace("_", "") | replace("-", "")}}Version{% endif %}": {
            "type": "string",
            "proposals": [
                "latest"
            ],
            "default": "latest",
            "description": "Select the {{pipx_package.display_name}} version you would like to install"
        },
        {% if pipx_package.injections is defined and pipx_package.injections |length > 0 %}   

        {% for pipx_injection in pipx_package.injections %}
{%- if pipx_injection.optional == "True" %}   
    "include{{ pipx_injection.display_name | replace(" ", "") | replace("_", "") | replace("-", "") | to_camel}}": {
            "type": "boolean",
            "default": true,
            "description": "Include {{pipx_injection.display_name}}"
        },
        {%- endif %}

        "{{ pipx_injection.display_name | replace(" ", "") | replace("_", "") | replace("-", "") | to_lower_camel}}Version": {
            "type": "string",
            "proposals": [
                "latest"
            ],
            "default": "latest",
            "description": "Select the {{pipx_injection.display_name}} version you would like to install"
        },
        {% endfor %}
        {%- endif %}

{% endfor %}
    }
}